(this["webpackJsonpfidelija-employee"]=this["webpackJsonpfidelija-employee"]||[]).push([[0],{142:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(11),c=a.n(r),o=a(199),i=a(57),s=a(14),u=a(20),l=a(49),j=a(15),b=a.n(j),d=a(25),p=a(50),h=a.n(p),O="https://api.fidelija.com.br/",m={authenticate:function(e){return Object(d.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(O,"oauth/token"),t.abrupt("return",h.a.post(a,e));case 2:case"end":return t.stop()}}),t)})))()},setLoggedUser:function(e,t){return Object(d.a)(b.a.mark((function a(){var n,r;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=JSON.stringify(e),r=JSON.stringify(t),localStorage.setItem("userData",n),localStorage.setItem("authData",r);case 4:case"end":return a.stop()}}),a)})))()},getEmployee:function(e){return Object(d.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(O,"api/employee-data"),t.abrupt("return",h.a.get(a,{headers:{Authorization:"".concat(e.token_type," ").concat(e.access_token)}}));case 2:case"end":return t.stop()}}),t)})))()},getAuthData:function(){var e=localStorage.getItem("authData");if(!e)return null;try{return JSON.parse(e)}catch(t){return console.log(t),null}},getLoggedUser:function(){var e=localStorage.getItem("userData");if(!e)return null;try{return JSON.parse(e)}catch(t){return console.log(t),null}},isAuthenticated:function(){return!!localStorage.getItem("authData")},clearLoggedUser:function(){localStorage.getItem("authData")&&(localStorage.removeItem("authData"),localStorage.removeItem("userData"),window.location.replace("/"))},getUserType:function(){if(localStorage.getItem("authData")){var e=JSON.parse(localStorage.getItem("userData")),t=e.is_admin,a=e.is_employee;if(1===t)return{is_admin:!0,is_employee:!1};if(1===a)return{is_employee:!0,is_admin:!1}}}},f="https://api.fidelija.com.br/",x=m.getAuthData()&&{headers:{Authorization:"".concat(m.getAuthData().token_type," ").concat(m.getAuthData().access_token)}},g={getUserByCpf:function(e){return Object(d.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(f,"api/user/cpf"),t.abrupt("return",h.a.post(a,e,x));case 2:case"end":return t.stop()}}),t)})))()},registerPoints:function(e){return Object(d.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(f,"api/points"),t.abrupt("return",h.a.post(a,e,x));case 2:case"end":return t.stop()}}),t)})))()}},v=a(4),y=function(e){var t=e.component,a=Object(l.a)(e,["component"]);return Object(v.jsx)(s.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return m.isAuthenticated()?Object(v.jsx)(s.a,{to:{pathname:"/",state:{from:e.location}}}):Object(v.jsx)(t,Object(u.a)({},e))}}))},k=function(e){var t=e.component,a=Object(l.a)(e,["component"]);return Object(v.jsx)(s.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return m.isAuthenticated()?Object(v.jsx)(t,Object(u.a)({},e)):Object(v.jsx)(s.a,{to:{pathname:"/",state:{from:e.location}}})}}))},S=a(19),w=a(188),C=a(206),N=a(53),D=a(200),I=a(189),B=a(203),_=a(186),A=a(190),U=a(191),L=a(201),P=a(92),J=a.n(P),W=a(175),z=a(205),E=a(178),R=Object(W.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#60c3ff"}}})),F=function(e){var t=R();return Object(v.jsx)(z.a,{className:t.backdrop,open:e.open,children:Object(v.jsx)(E.a,{color:"inherit"})})},T=a(204),q=a(202),G=function(e){return Object(v.jsx)(T.a,{open:e.toggleSnack,autoHideDuration:e.time,onClose:e.onClose,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(v.jsx)(q.a,{onClose:e.onClose,severity:e.color,variant:"filled",children:e.children})})},M=a(181),V=a(182),H=a(180),Q=a(94),Y=a(185),$=a(183),K=a(187),X=Object(W.a)((function(e){return{menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},appBar:{marginBottom:"30px"}}})),Z=function(e){var t=Object(n.useState)(!1),a=Object(S.a)(t,2),r=a[0],c=a[1],o=X(),i=Object(n.useRef)(null);return Object(v.jsx)(M.a,{position:"static",className:o.appBar,children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{edge:"start",className:o.menuButton,color:"inherit","aria-label":"menu",children:Object(v.jsx)($.a,{})}),Object(v.jsx)(N.a,{variant:"h6",className:o.title,children:"Painel do funcion\xe1rio"}),Object(v.jsxs)("div",{children:[Object(v.jsx)(H.a,{onClick:function(){return c(!0)},ref:i,children:Object(v.jsx)(C.a,{src:"https://api.fidelija.com.br/"+m.getLoggedUser().photo})}),Object(v.jsx)(Q.a,{anchorEl:i.current,open:r,onClose:function(){return c(!1)},children:Object(v.jsx)(Y.a,{component:_.a,endIcon:Object(v.jsx)(K.a,{}),color:"secondary",onClick:function(){m.clearLoggedUser()},children:"Sair"})})]})]})})},ee=a(91),te=function(e){var t=e.inputRef,a=e.onChange,n=Object(l.a)(e,["inputRef","onChange"]);return Object(v.jsx)(ee.a,Object(u.a)(Object(u.a)({},n),{},{getInputRef:t,onValueChange:function(t){a({target:{name:e.name,value:t.value}})},thousandSeparator:".",decimalSeparator:",",isNumericString:!0,allowNegative:!1,prefix:"R$ "}))},ae=Object(W.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),ne=function(){var e=Object(n.useState)(""),t=Object(S.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),o=Object(S.a)(c,2),i=o[0],s=o[1],u=Object(n.useState)(!1),l=Object(S.a)(u,2),j=l[0],p=l[1],h=Object(n.useState)(!1),O=Object(S.a)(h,2),f=O[0],x=O[1],g=Object(n.useState)(""),y=Object(S.a)(g,2),k=y[0],P=y[1],W=ae(),z=function(){var e=Object(d.a)(b.a.mark((function e(){var t,n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),t={username:a,password:i,scope:"*",client_id:1,grant_type:"password",client_secret:"IQLstf5Jhow51iiBGDxp9BPxlfMDwLvnxrsTF6n6"},e.prev=2,e.next=5,m.authenticate(t);case 5:return n=e.sent,e.next=8,m.getEmployee(n.data);case 8:if(!(r=e.sent).data.employeeInfo){e.next=16;break}return e.next=12,m.setLoggedUser(r.data,n.data);case 12:p(!1),window.location.replace("/home"),e.next=19;break;case 16:p(!1),P("Acesso n\xe3o autorizado"),x(!0);case 19:e.next=27;break;case 21:e.prev=21,e.t0=e.catch(2),console.log(e.t0),p(!1),P("Ocorreu um erro tente novamente."),x(!0);case 27:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)(w.a,{component:"main",maxWidth:"xs",children:[Object(v.jsx)(F,{open:j}),Object(v.jsx)(G,{toggleSnack:f,time:4500,onClose:function(){return x(!1)},color:"error",children:k}),Object(v.jsxs)("div",{className:W.paper,children:[Object(v.jsx)(C.a,{className:W.avatar,children:Object(v.jsx)(J.a,{})}),Object(v.jsx)(N.a,{component:"h1",variant:"h5",children:"Login de Funcion\xe1rios"}),Object(v.jsxs)("div",{className:W.form,children:[Object(v.jsx)(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"Email",name:"email",type:"email",value:a,onChange:function(e){return r(e.target.value)}}),Object(v.jsx)(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Senha",type:"password",value:i,onChange:function(e){return s(e.target.value)}}),Object(v.jsx)(I.a,{control:Object(v.jsx)(B.a,{value:"remember",color:"primary"}),label:"Lembrar-me"}),Object(v.jsx)(_.a,{fullWidth:!0,variant:"contained",color:"primary",className:W.submit,onClick:function(){return z()},children:"Entrar"}),Object(v.jsxs)(A.a,{container:!0,children:[Object(v.jsx)(A.a,{item:!0,xs:!0,children:Object(v.jsx)(U.a,{href:"#",variant:"body2",children:"Esqueceu a senha?"})}),Object(v.jsx)(A.a,{item:!0,children:Object(v.jsx)(U.a,{href:"#",variant:"body2",children:"Ainda n\xe3o possui uma conta?"})})]})]})]}),Object(v.jsx)(L.a,{mt:8,children:Object(v.jsxs)(N.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(v.jsx)(U.a,{color:"inherit",href:"https://parceiro.fidelija.com.br/",children:"Fidelij\xe1"})," ",(new Date).getFullYear(),"."]})})]})},re=a(93),ce=a.n(re),oe=a(192),ie=a(144),se=a(184),ue=a(145),le=a(193),je=a(194),be=a(197),de=a(195),pe=a(196),he=a(198),Oe=a(63),me=Object(W.a)((function(e){return{button:{color:e.palette.common.white,backgroundColor:Oe.a[400],"&:hover":{backgroundColor:Oe.a[500]}},paper:{padding:"10px"},gridContainer:{marginBottom:"80px"},fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},header:{marginBottom:"20px"}}})),fe=function(){var e=Object(n.useState)(!1),t=Object(S.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),o=Object(S.a)(c,2),i=o[0],s=o[1],l=Object(n.useState)(!1),j=Object(S.a)(l,2),p=j[0],h=j[1],O=Object(n.useState)(""),m=Object(S.a)(O,2),f=m[0],x=m[1],y=Object(n.useState)(null),k=Object(S.a)(y,2),I=k[0],B=k[1],U=Object(n.useState)(""),L=Object(S.a)(U,2),P=L[0],J=L[1],W=Object(n.useState)(""),z=Object(S.a)(W,2),E=z[0],R=z[1],T=me(),q=Object(n.useRef)(null),M=function(){var e=Object(d.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),t={cpf:P},e.prev=2,e.next=5,g.getUserByCpf(t);case 5:a=e.sent,B(a.data),r(!1),!a.data&&P.length>0&&(x("Usu\xe1rio n\xe3o encontrado."),s(!0)),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),r(!1),x("N\xe3o foi poss\xedvel buscar o usu\xe1rio."),s(!0);case 17:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(d.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!1),t={id:I.id,ammount:E},e.prev=2,e.next=5,g.registerPoints(t);case 5:B(null),R(""),J(""),r(!1),x("Usu\xe1rio pontuado com sucesso."),h(!0),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),r(!1),x("N\xe3o foi possivel pontuar o usu\xe1rio"),s(!0),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z,{children:"Pontuar usu\xe1rio"}),Object(v.jsx)(F,{open:a}),Object(v.jsx)(G,{toggleSnack:i||p,time:4500,onClose:function(){s(!1),h(!1)},color:p?"success":"warning",children:f}),Object(v.jsxs)(w.a,{maxWidth:"lg",children:[Object(v.jsxs)("div",{className:T.header,children:[Object(v.jsx)(N.a,{variant:"h6",children:"Pontuar usu\xe1rio"}),Object(v.jsx)(oe.a,{})]}),Object(v.jsxs)(A.a,{className:T.gridContainer,container:!0,spacing:3,direction:"column",justifyContent:"center",children:[Object(v.jsx)(A.a,{item:!0,xs:12,children:Object(v.jsxs)(ie.a,{variant:"outlined",className:T.paper,children:[Object(v.jsx)(ce.a,{mask:"999.999.999-99",maskChar:"",value:P,onChange:function(e){return J(e.target.value)},onBlur:M,children:function(e){return Object(v.jsx)(D.a,Object(u.a)(Object(u.a)({},e),{},{fullWidth:!0,variant:"outlined",label:"CPF",margin:"normal",type:"text"}))}}),Object(v.jsx)(D.a,{fullWidth:!0,variant:"outlined",label:"Valor da compra",margin:"normal",name:"valor",value:E,onChange:function(e){return R(e.target.value)},InputProps:{inputComponent:te}})]})}),I&&Object(v.jsx)(A.a,{item:!0,xs:12,children:Object(v.jsxs)(ie.a,{variant:"outlined",children:[Object(v.jsxs)(se.a,{dense:!1,children:[Object(v.jsxs)(ue.a,{children:[Object(v.jsx)(le.a,{children:Object(v.jsx)(C.a,{src:"https://api.fidelija.com.br/"+I.photo,alt:I.name})}),Object(v.jsx)(je.a,{children:I.name})]}),Object(v.jsxs)(ue.a,{children:[Object(v.jsx)(le.a,{children:Object(v.jsx)(C.a,{style:{backgroundColor:"#604bd2"},children:Object(v.jsx)(de.a,{})})}),Object(v.jsx)(je.a,{children:I.cpf})]}),Object(v.jsxs)(ue.a,{children:[Object(v.jsx)(le.a,{children:Object(v.jsx)(C.a,{style:{backgroundColor:"rgb(38 165 43)"},children:Object(v.jsx)(pe.a,{})})}),Object(v.jsx)(je.a,{children:Math.ceil(5*E)})]})]}),Object(v.jsx)("div",{style:{padding:"10px"},children:Object(v.jsx)(_.a,{className:T.button,variant:"contained",color:"inherit",fullWidth:!0,size:"medium",disabled:""===E,onClick:V,children:"Pontuar"})})]})})]}),Object(v.jsx)("input",{type:"file",accept:"image/*",capture:"camera",ref:q,style:{display:"none"}}),Object(v.jsx)(be.a,{className:T.fab,color:"secondary",onClick:function(){return q.current.click()},children:Object(v.jsx)(he.a,{})})]})]})},xe=function(){return Object(v.jsx)(i.a,{children:Object(v.jsxs)(s.d,{children:[Object(v.jsx)(y,{path:"/",exact:!0,component:ne}),Object(v.jsx)(k,{path:"/home",component:fe})]})})};var ge=function(){return Object(v.jsxs)("div",{style:{overflow:"hidden"},children:[Object(v.jsx)(o.a,{}),Object(v.jsx)(xe,{})]})};c.a.render(Object(v.jsx)(ge,{}),document.getElementById("root"))}},[[142,1,2]]]);
//# sourceMappingURL=main.55dfe3db.chunk.js.map